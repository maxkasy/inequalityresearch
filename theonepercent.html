<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Empirical Research on Economic Inequality</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/offcanvas.css" rel="stylesheet">
    <!-- <link href="css/pushy.css" rel="stylesheet" > -->
    <link rel="stylesheet" href="css/demo.css">
    <link href="css/simple-sidebar.css" rel="stylesheet">

	<link href='https://fonts.googleapis.com/css?family=Martel|Martel+Sans' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>	
	
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <script src="../../assets/js/ie8-responsive-file-warning.js"></script>
    <script src="js/ie-emulation-modes-warning.js"></script>
    <script src="js/pushy.min.js"></script>
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      
    <!-- Google Analytics -->
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-76905463-1', 'auto');
	ga('send', 'pageview');
	</script>
	
  </head>

  <body>
	<div id="wrapper">  
	
    <header class="site-header push">	     
	<div class="menu-btn"><div class="container" onclick="myFunction(this)">
		<div class="bar1"></div>
		<div class="bar3"></div>
		<div class="site-header-title">EMPIRICAL RESEARCH ON ECONOMIC INEQUALITY</div>
    </div>
    </header>

    <div class="container">
      <div class="row row-offcanvas row-offcanvas-left">
        <div class="col-xs-12 col-sm-9">
                   <nav class="pushy pushy-left" id="sidebar-wrapper">
            <ul class="sidebar-nav">
                        <li class="pushy-link"><a href="introduction.html">Introduction</a>
                </li>
                <li class="pushy-submenu">
                    <a href="#">Justice & Research</a>
                    <ul>
                        <li class="pushy-link"><a href="justiceresearch.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="justiceresearch_slides.html">SLIDES</a></li>
                    </ul>
                </li>
                <li class="pushy-submenu-open">
                    <a href="#">The 1%</a>
                    <ul>
                        <li class="pushy-link"><span class="link-active"><a href="theonepercent.html">CHAPTER</span></a></li>
                        <li class="pushy-link"><a href="theonepercent_slides.html">SLIDES</a></li>
                        <li class="pushy-link"><a href="theonepercent_exercises.html">EXERCISES</a></li>
                    </ul>
                </li>
                <li class="pushy-submenu">
                    <a href="#">Gender Inequality</a>
                    <ul>
                        <li class="pushy-link"><a href="genderinequality.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="genderinequality_slides.html">SLIDES</a></li>
                    </ul>
                </li>
                <li class="pushy-submenu">
                	<a href="#">Discrimination</a>
                    <ul>
                        <li class="pushy-link"><a href="discrimination.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="discrimination_slides.html">SLIDES</a></li>
                        <li class="pushy-link"><a href="discrimination_exercises.html">EXERCISES</a></li>
                    </ul>
                <li class="pushy-submenu">
                	<a href="#">Unions</a>
                     <ul>
                        <li class="pushy-link"><a href="unions.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="unions_slides.html">SLIDES</a></li>
                        <li class="pushy-link"><a href="unions_exercises.html">EXERCISES</a></li>
                    </ul>
                <li class="pushy-submenu">
                <a href="#">Migration, Technology, Education</a>
                    <ul>
                        <li class="pushy-link"><a href="migration.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="migration_slides.html">SLIDES</a></li>
                    </ul>                
                 <li class="pushy-submenu">
                 <a href="#">Intergenerational Mobility</a>
                    <ul>
                        <li class="pushy-link"><a href="intergenerationalmobility.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="intergenerationalmobility_slides.html">SLIDES</a></li>
                    </ul>                
                 <li class="pushy-submenu">
                 <a href="#">Changing Prices</a>
                    <ul>
                        <li class="pushy-link"><a href="changingprices.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="changingprices_slides.html">SLIDES</a></li>
                        <li class="pushy-link"><a href="changingprices_exercises.html">EXERCISES</a></li>  
                    </ul>               
                 <li class="pushy-submenu">
                 <a href="#"> Redistributive Taxation</a>
                 	<ul>
                        <li class="pushy-link"><a href="redistributivetaxation.html">CHAPTER</a></li>
                        <li class="pushy-link"><a href="redistributivetaxation_slides.html">SLIDES</a></li>
                 	</ul>
                 <li class="pushy-link"><a href="guestlectures.html">Guest Lectures</a></li>
                 	<br>
                 <li class="pushy-link"><a href="about.html">About</a></li>
                 <li class="pushy-link"><a href="furtherreadings.html">Further Readings</a></li>
                 <li class="pushy-link"><a href="http://wealthometer.org">Wealthometer.org</a></li>

				 </ul>
        </nav> 


        <div id="page-container-wrapper">
          <div class="jumbotron">
	          <h5> CHAPTER 3 </h5>
            <h1>The 1% &mdash; <br>The Pareto distribution and maximum likelihood</h1><br>
            <h4> REFERENCE: <a href="http://www.nber.org/papers/w15408" target="_blank"> Top Incomes in the Long Run of HistoryÂ»</a></h4>
            <p> Income inequality has been changing quite dramatically over time, in particular at the very top of the distribution, as illustrated by figure 1 on the next page, reproduced from Piketty's "Capital in the 21st century." How do we know this? In particular thanks to the careful historical work by various authors, reviewed in Atkinson et al. (2011), using tax data. In order to estimate top income shares, we need estimates of (i) how much income the rich received, and (ii) how large the total income generated in the economy was. In this chapter we shall be concerned with the question of how to get the first of these. Top incomes are estimated in this literature using historical tax data. The distribution of top incomes (and of top wealth holdings) is well approximated by the so-called Pareto distribution. The problem of estimating top incomes reduces to the problem of estimating the parameter \(\alpha\) of this distribution.</p>
<br>

<p><h2>1. Definition of the Pareto distribution</h2></p>
<p> We shall suppose incomes \(Y\) above an income level of \(\underline{y}\) follow a Pareto distribution. This assumption was shown to provide a good approximation in many studies. The Pareto distribution is defined by the property that</p>
<h6>(1)</h6>
$$
P(Y>y | Y \geq \underline{y}) = \left ( \underline{y} /y\right )^{\alpha_0}
$$ 
<p>for \(y \geq \underline{y}\), where \(\alpha_0 >1\). That is, the <b>share of incomes above a cutoff</b> \(y\) declines with \(y^{-\alpha_0}\). Our goal is to estimate the Pareto parameter \(\alpha_0\), which we can then use to calculate top income shares.</p>
<p>
We can calculate the <b>density</b> of the Pareto distribution, conditional on \(Y \geq \underline{y}\), by taking derivatives:</p>
<h6>(2)</h6>
$$f(Y;\alpha_0) = - \frac{\partial}{\partial y}P(Y>y | Y \geq \underline{y}) = - \frac{\partial}{\partial y} \left ( \underline{y} /y\right )^{\alpha_0} = 
\alpha_0 \left ( \underline{y} /y\right )^{\alpha_0}\cdot y^{-1}
.$$
<p> The Pareto distribution has the interesting feature that, for any \(y\geq \underline{y}\),</p>
<h6>(3)</h6>
$$E[Y|Y\geq y] = \frac{\alpha_0}{\alpha_0-1} \cdot y.$$
</p>
<br>
<p><caption>Top 1% income share in the US. Reproduced from Piketty 2014</caption>
	<div class="row">
	 	  <div class="col-md-12"><img src= "img/theonepercent.png"></div>
	</div>
<p>Try to verify this by calculating the expectation by integration. This equation tells us that the <b>average income of those receiving more than </b> \(y\), relative to \(y\), equals \({\alpha_0}/({\alpha_0-1})\) &mdash; no matter what value \(y\) we pick! The smaller the parameter \(\alpha_0\) is, the larger are the incomes received by the very rich, and the larger will be our estimates of income inequality.
Suppose we know the cutoff \(q^{99}\) such that 99% of incomes are below this cutoff. We can then calculate the <b>average income of the 1</b> as $$\overline{y}^{1\%} = \frac{\alpha_0}{\alpha_0-1} \cdot q^{99}.$$

You can find more information on the Pareto distribution <a href = https://en.wikipedia.org/wiki/Pareto_distribution>HERE</a>.
</p>
<br>

<p><h2>2. Maximum likelihood</h2>

Suppose you have i.i.d. observations \(y_1, \ldots, y_n\) of incomes above \(\underline{y}\) from historical tax data. We want to estimate the parameter \(\alpha\) using this data. One general method to construct estimators is to find the parameter which gives us the highest "probability" for finding the observations that we have; this idea is called maximum likelihood estimation (MLE).
Formally, the <b>maximum likelihood estimator</b> is defined as</p>
<h6>(4)</h6>
$$\widehat{\alpha}^{MLE} = {\operatorname{argmax}}_\alpha \prod_{i=1}^n f(y_i; \alpha) = {\operatorname{argmax}}_\alpha \sum_{i=1}^n \log(f(y_i; \alpha)).
$$
<p>This is the value of \(\alpha\) which maximizes the density of our observations. Note that between the second and third term we applied logs to everything &mdash; this is OK, since the logarithm is monotonically increasing and this therefore does not change the maximization problem.
</p>

<p>The <b>first order condition</b> for the maximization problem defining the MLE (in log terms) is given by</p>
$$
\frac{\partial}{\partial \alpha} \sum_{i=1}^n \log(f(y_i; \alpha)) = 0.
$$
<p>We shall now plug in the expression for the density of the Pareto distribution which we derived before. The log likelihood of observation \(i\), that is the \(\log\) of its density given \(\alpha\), is equal to</p>
$$\log(f(y_i; \alpha)) = \log( \alpha\left ( \underline{y} /y_i\right )^{\alpha}\cdot y_i^{-1}  ) = \log( \alpha) + \alpha \log \left ( \underline{y} /y_i\right )
-\log(y_i).$$
We get  
$$\begin{align*}
0 &=\frac{\partial}{\partial \alpha} \sum_{i=1}^n \log( \alpha\left ( \underline{y} /y_i\right )^{\alpha}\cdot y^{-1}  )\\
&=  \sum_{i=1}^n \left ( \frac{1}{\alpha} +  \log \left ( \underline{y} /y_i\right ) \right )
\end{align*}$$
<p>Solving for \(\alpha\) yields</p>
<h6>(5)</h6>

$$
\begin{equation}
\widehat{\alpha}^{MLE} = \frac{n}{
\sum_i \log \left (y_i/ \underline{y} \right )}.
\label{eq:alphaMLE}
\end{equation}
$$
</p>
<br>


<p><h2>3. Censored data</h2></p>
<p>
Unfortunately we usually don't observe the actual incomes that rich people received in the available tax data. All that is available from historical records is the number of tax filers that fall into several <b>tax brackets</b> of the form \([y_l, y_u]\).
Fortunately we can still estimate the Pareto parameter from such data &mdash;  which makes the Pareto distribution a very useful model.
The conditional probability that \(Y\) falls in the interval \([y_l, y_u]\) can be calculated as
<h6>(6)</h6>
$$
\begin{align}
P(Y \in [y_l, y_u] |Y \geq \underline{y}) &= 
P(Y>y_l | Y \geq \underline{y}) - P(Y>y_u | Y \geq \underline{y}) \nonumber \\
&=\left ( \underline{y} /y_l\right )^{\alpha_0} - \left ( \underline{y} /y_u\right )^{\alpha_0}.
\end{align}
$$
</p>
<p>
For simplicity, suppose that we just observe two tax brackets, that is, we only have aggregate tax data which tell you the number \(N_1\) of taxpayers falling in the bracket \(\underline[{y}, y_l)\), and the number \(N_2\) of tax payers falling in the bracket \([y_l, \infty)\)
What is the distribution of \(N_2\) conditional on \(N_1 + N_2 =n?\)</p>
<br>
<p>We can write \(N_2\) as a sum of independent Bernoulli random variables which take on the values 0 and 1.</p>
$$N_2 = \sum_{i=1}^n \mathbf{1}(Y_i> y_l ),$$
where the probability that any of these variables equals \(1\) is given by
$$p(\alpha_0) = P (Y> y_l | Y> \underline{y}) =  \left ( \underline{y} /y_l\right )^{\alpha_0}.$$
<p>It follows that <b>\(N_2\) is binomially distributed </b>conditional on \(N_1+N_2=n\), that is</p>
<h6>(7)</h6>
$$\begin{equation}N_2\sim Bin\left (n, p(\alpha_0)\right ),\end{equation}$$
<br>
and
<br>
$$P(N_2 = n_2 | N_1 + N_2 =n; \alpha) = \binom{n}{n_2} \cdot p(\alpha_0)^{n_2} (1-p(\alpha_0))^{n-n_2}.$$
You can find more information on the Binomial distribution <a href="https://en.wikipedia.org/wiki/Binomial_distribution">HERE</a>.
</p>
<br>
 

<p><h2>4. Maximum likelihood with censored data</h2></p>
<p>
As before, we want to construct an estimator of \(\alpha_0\), but using only the interval censored data. As before, we can construct such an estimator using maximum likelihood, that is
$$\widehat{\alpha}^{MLE} = {\arg\!\max}\alpha P(N_2 = n_2 | N_1 + N_2 =n; \alpha)$$
is the value which maximizes the probability of observing a number \(N_2\) of observations in the upper tax bracket.</p>
<br>
<p>
The <b>first order condition</b> for the MLE is given by
$$\begin{align*}
0&=\frac{\partial}{\partial \alpha} \log f(N_2|N_1+N_2; \alpha)\\
&= \frac{\partial}{\partial \alpha} \left( \log \binom{n}{N_2} + N_2 \log p + N_1 \log (1-p) \right )\\
&= \left (\frac{N_2}{p} - \frac{N_1}{1-p}\right ) \cdot \frac{\partial}{\partial \alpha} p\\
&= \left (\frac{N_2}{\left ( \underline{y} /y_l\right )^{\alpha}} - \frac{N_1}{1- \left ( \underline{y} /y_l\right )^{\alpha}}\right )
\cdot  \frac{\partial}{\partial \alpha} p.
\end{align*}$$</p>
<p>
Since \(\frac{\partial}{\partial \alpha} p \neq 0\), the first term has to vanish, and after doing some algebra we see that \(\widehat{\alpha}^{MLE} \) is the solution to the equation
$$\left ( \underline{y} /y_l\right )^{\widehat{\alpha}^{MLE} } = \frac{N_2}{n},$$
so that</p>
<h6>(8)</h6>
$$\begin{equation}
\widehat{\alpha}^{MLE}  = \frac{\log (N_2 /n)}{\log \left ( \underline{y} /y_l\right )}.
\label{eq:alphaMLEcensored}
\end{equation}$$
The larger the share of our observations is that falls in the upper tax bracket, the larger is our estimate of \(\alpha\).
</p><br>


<p><h2>5. Piketty's \(r-g\) and the Pareto parameter </h2></p>
<p>
So far, we have discussed how to estimate \(\alpha\) and how to use this estimate to calculate top income shares.
But why do the top tails of income and wealth follow a Pareto distribution, and what determines the parameter \(\alpha\)
One possible story is given by the formal argument underlying Piketty's book (though hidden very deeply in the references), which relates the rate of return \(r\) on capital, relative to economic growth \(g\), to the long run inequality of wealth.</p><br>
<p>
I will give a heuristic proof of this argument; this is complicated and optional material. Suppose that the <b>wealth</b> \(Y\) of a family \(i\) <b>follows the process</b><br>
<h6>(9)</h6>
$$\begin{equation}Y_{i,1} =  w_i + R_i\cdot Y_{i,0}\label{eq:wealthprocess}\end{equation}$$
over time, where \(Y_{i,1} \) denotes the wealth of children, \(Y_{i,0}\) the wealth of parents, \(w_i\) reflects savings from earnings, and \(R_i\) is the rate of savings from capital income, corresponding to Piketty's \(r-g\). Suppose further that $$(w_i, R_i) \perp Y_{i,0},$$ that is random shocks to earnings, rates of return, or savings are independent from past wealth. This is a strong assumption, which, however, could be relaxed.</p>
<br>
<p>A so-called <b>stationary distribution</b>for \(Y_i\) is one where the distribution of \(Y_{i,1}\) is the same as that for \(Y_{i,0}\) &mdash; inequality among children is the same as inequality among parents. Under fairly general conditions, this process will <b>converge</b> to a stationary distribution with Pareto tail as long as \(E[R] <1\) (otherwise inequality would explode over time), so that we can assume that the distribution of \(Y_0\) is already approximately Pareto in the tail of the distribution, that is for large values of wealth,
$$P(Y_0>y | Y_0 \geq \underline{y}) \approx \left ( \underline{y} /y\right )^{\alpha_0}.$$
</p>
<p>
What Pareto parameter yields a stationary tail? In the tail,\(w_i\) (savings from earnings) is negligibly small relative to \(R_i \cdot Y_{i,0}\) (savings from capital income), so that <b>stationarity requires</b>
$$\begin{align*}
P(Y_0>y )&=P(Y_1>y ) = P(w + R\cdot Y_0>y  )\\
& \approx 
P(Y_0>y/R )
= E[P(Y_0>y/R | R)]
\end{align*}$$
for large \(y\), where in the second line we just dropped \(w\) from the exact equality. In the last expression we first condition on \(R\), and then average out over the distribution of \(R\).
Plugging the Pareto distribution for \(Y_0\) into these expressions we get
$$ \left ( \underline{y} /y\right )^{\alpha_0} = E\left [\left ( \underline{y} /(y/R)\right )^{\alpha_0}\right ].$$
Dividing by \(\left ( \underline{y} /y\right )^{\alpha_0}\) shows that this is equivalent to<br>
<h6>(10)</h6>
$$
\begin{equation}
E\left [R^{\alpha_0}\right ] =1.
\end{equation} $$
<br>
We have derived the equation mapping the distribution of \(R\) to the Pareto parameter \(\alpha_0\).
</p>
<br>
<p>The <b>intuition</b> behind our argument and this equation is as follows: rich families move up the wealth distribution if their \(R_i >1\), they move down if their \(R_i<1\). Stationarity requires that upward- and downward movements cancel each other &mdash; as many families move down as up in any given range of the tail. If it's more likely to move down than up (\(R_i\) is mostly small), then there have to be fewer people that are very rich rather than just rich (large \(\alpha\), little inequality), for these movements to cancel. If it's equally likely to move up as down (\(R_i\) is centered close to \(1\)), there have to be almost as many very rich people as rich people (small \(\alpha\), lots of inequality).
</p>
<br>
<hr>

<p>	
<h5>REFERENCES</h5>
<h4>Atkinson, A. B., Piketty, T., and Saez, E. (2011). Top incomes in the long run
of history. <em>Journal of Economic Literature</em>, 49(1): 3 &ndash; 71.</h4>

<h4>Piketty, T. (2014). <em>Capital in the 21st Century</em>. Harvard University Press,
Cambridge.</h4>
      <hr>
<footer>
	   <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a><br><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution - <br>NonCommercial - ShareAlike 4.0 International License.</a>
</footer>
</div>
    <!--/.container-->

</div> <!-- #wrapper -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')</script>
    <script src="js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
    <script src="js/jquery.js"></script>
	<script src="js/bootstrap.js"></script>
    <script src="js/offcanvas.js"></script>
    <script src="js/pushy.js"></script>
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    <!-- Menu Toggle Script -->
    <script>
    $(".menu-btn").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>
    
    <script>
	function myFunction(x) {
    x.classList.toggle("change");
	}
	</script>
	
  </body>
</html>
